{"ast":null,"code":"var _jsxFileName = \"/mnt/c/Users/antr9/Desktop/studypal-master/frontend/src/index.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App'; // import * as serviceWorker from './serviceWorker';\n\nimport axios from 'axios';\nimport Root from \"./components/root\";\nimport configureStore from './store/store';\nimport './index.css';\nimport getYelpCafeById from './util/yelp_api';\nimport jwt_decode from 'jwt-decode';\nimport { setAuthToken } from './util/session_api_util';\nimport { logout } from './actions/session_actions';\nimport { updateProfile, getUser } from './util/user_api_util'; // function saveToLocalStorage(state){\n//     //wrap because won't save to localStorage is private mode\n//         try{\n//             const serializedState= JSON.stringify(state)\n//             //give key state\n//             localStorage.setItem('state',serializedState)\n//         }catch(e){\n//             console.log(e);\n//         }\n//     }\n// function loadFromLocalStorage(){\n//     try{\n//         const serializedState = localStorage.getItem('state')\n//         if(serializedState === null)return undefined;\n//         return JSON.parse(serializedState)\n//     }catch(e){\n//         console.log(e);\n//         return undefined;\n//     }\n// }\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  // let store = configureStore({});\n  let store; // const persistedState = loadFromLocalStorage();\n\n  if (localStorage.jwtToken) {\n    setAuthToken(localStorage.jwtToken);\n    const decodedUser = jwt_decode(localStorage.jwtToken);\n    const preloadedState = {\n      session: {\n        isAuthenticated: true,\n        user: decodedUser\n      }\n    };\n    store = configureStore(preloadedState); // store = configureStore(persistedState);\n    //checking if jwt passed its configuration\n    //getting it in seconds\n\n    const currentTime = Date.now() / 1000; //if decoded expiration time is less than currentTime\n\n    if (decodedUser.exp < currentTime) {\n      //Logout the user and redirect to the login page\n      store.dispatch(logout());\n      window.location.href = 'login';\n    }\n  } else {\n    store = configureStore();\n  }\n\n  const root = document.getElementById(\"root\");\n  ReactDOM.render(React.createElement(Root, {\n    store: store,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }), root);\n  window.getState = store.getState;\n}); // If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n//don't need\n// serviceWorker.unregister();\n//set axios on the window\n// TESTING APIS","map":{"version":3,"sources":["/mnt/c/Users/antr9/Desktop/studypal-master/frontend/src/index.js"],"names":["React","ReactDOM","App","axios","Root","configureStore","getYelpCafeById","jwt_decode","setAuthToken","logout","updateProfile","getUser","document","addEventListener","store","localStorage","jwtToken","decodedUser","preloadedState","session","isAuthenticated","user","currentTime","Date","now","exp","dispatch","window","location","href","root","getElementById","render","getState"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAO,aAAP;AACA,OAAOC,GAAP,MAAgB,OAAhB,C,CACA;;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,IAAP,MAAiB,mBAAjB;AACA,OAAOC,cAAP,MAA2B,eAA3B;AACA,OAAO,aAAP;AACA,OAAOC,eAAP,MAA4B,iBAA5B;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,SAAQC,YAAR,QAA2B,yBAA3B;AACA,SAAQC,MAAR,QAAqB,2BAArB;AACA,SAAQC,aAAR,EAAuBC,OAAvB,QAAqC,sBAArC,C,CAGA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGAC,QAAQ,CAACC,gBAAT,CAA0B,kBAA1B,EAA8C,MAAM;AAChD;AACA,MAAIC,KAAJ,CAFgD,CAGhD;;AAEA,MAAGC,YAAY,CAACC,QAAhB,EAAyB;AACrBR,IAAAA,YAAY,CAACO,YAAY,CAACC,QAAd,CAAZ;AACA,UAAMC,WAAW,GAAGV,UAAU,CAACQ,YAAY,CAACC,QAAd,CAA9B;AACA,UAAME,cAAc,GAAG;AAACC,MAAAA,OAAO,EAAE;AAACC,QAAAA,eAAe,EAAE,IAAlB;AAAwBC,QAAAA,IAAI,EAAEJ;AAA9B;AAAV,KAAvB;AAEAH,IAAAA,KAAK,GAAGT,cAAc,CAACa,cAAD,CAAtB,CALqB,CAMrB;AACA;AACA;;AACA,UAAMI,WAAW,GAAGC,IAAI,CAACC,GAAL,KAAW,IAA/B,CATqB,CAUrB;;AACA,QAAGP,WAAW,CAACQ,GAAZ,GAAkBH,WAArB,EAAiC;AAC7B;AACAR,MAAAA,KAAK,CAACY,QAAN,CAAejB,MAAM,EAArB;AACAkB,MAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,OAAvB;AACH;AAEJ,GAjBD,MAiBK;AACDf,IAAAA,KAAK,GAAGT,cAAc,EAAtB;AACH;;AAED,QAAMyB,IAAI,GAAGlB,QAAQ,CAACmB,cAAT,CAAwB,MAAxB,CAAb;AACA9B,EAAAA,QAAQ,CAAC+B,MAAT,CAAgB,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAElB,KAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAhB,EAAuCgB,IAAvC;AAEAH,EAAAA,MAAM,CAACM,QAAP,GAAkBnB,KAAK,CAACmB,QAAxB;AACH,CA9BD,E,CAmCA;AACA;AACA;AAEA;AACA;AAEA;AAGA","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n// import * as serviceWorker from './serviceWorker';\nimport axios from 'axios';\nimport Root from \"./components/root\";\nimport configureStore from './store/store';\nimport './index.css'\nimport getYelpCafeById from './util/yelp_api';\nimport jwt_decode from 'jwt-decode';\nimport {setAuthToken} from './util/session_api_util';\nimport {logout} from './actions/session_actions';\nimport {updateProfile, getUser} from './util/user_api_util';\n\n\n// function saveToLocalStorage(state){\n//     //wrap because won't save to localStorage is private mode\n//         try{\n//             const serializedState= JSON.stringify(state)\n//             //give key state\n//             localStorage.setItem('state',serializedState)\n    \n//         }catch(e){\n//             console.log(e);\n//         }\n//     }\n\n// function loadFromLocalStorage(){\n//     try{\n//         const serializedState = localStorage.getItem('state')\n//         if(serializedState === null)return undefined;\n//         return JSON.parse(serializedState)\n//     }catch(e){\n//         console.log(e);\n//         return undefined;\n//     }\n// }\n\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    // let store = configureStore({});\n    let store;\n    // const persistedState = loadFromLocalStorage();\n\n    if(localStorage.jwtToken){\n        setAuthToken(localStorage.jwtToken);\n        const decodedUser = jwt_decode(localStorage.jwtToken);\n        const preloadedState = {session: {isAuthenticated: true, user: decodedUser}};\n    \n        store = configureStore(preloadedState);\n        // store = configureStore(persistedState);\n        //checking if jwt passed its configuration\n        //getting it in seconds\n        const currentTime = Date.now()/1000;\n        //if decoded expiration time is less than currentTime\n        if(decodedUser.exp < currentTime){\n            //Logout the user and redirect to the login page\n            store.dispatch(logout());\n            window.location.href = 'login';\n        }\n\n    }else{\n        store = configureStore();\n    }\n    \n    const root = document.getElementById(\"root\");\n    ReactDOM.render(<Root store={store}/>, root);\n\n    window.getState = store.getState\n})\n\n\n\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n\n//don't need\n// serviceWorker.unregister();\n\n//set axios on the window\n\n\n// TESTING APIS\n"]},"metadata":{},"sourceType":"module"}