{"ast":null,"code":"import * as SessionAPIUtil from \"../util/session_api_util\";\nimport jwt_decode from 'jwt-decode'; // import SessionErrorsReducer from \"../reducers/session_errors_reducer\";\n\nexport const RECEIVE_CURRENT_USER = \"RECEIVE_CURRENT_USER\";\nexport const LOGOUT_CURRENT_USER = \"LOGOUT_CURRENT_USER\";\nexport const RECEIVE_ERRORS = \"RECEIVE_ERRORS\";\nexport const RECEIVE_USER_SIGN_IN = 'RECEIVE_USER_SIGN_IN';\nexport const CLEAR_ERRORS = 'CLEAR_ERRORS';\nexport const RECEIVE_PREFERENCES = \"RECEIVE_PREFERENCES\";\n\nconst receiveCurrentUser = currentUser => {\n  return {\n    type: RECEIVE_CURRENT_USER,\n    currentUser\n  };\n};\n\nconst logoutCurrentUser = () => ({\n  type: LOGOUT_CURRENT_USER\n});\n\nconst receiveErrors = errors => ({\n  type: RECEIVE_ERRORS,\n  errors\n}); //added by Fei\n\n\nconst receiveUserSignIn = currentUser => {\n  return {\n    type: RECEIVE_USER_SIGN_IN,\n    currentUser\n  };\n};\n\nexport const clearErrors = () => {\n  return {\n    type: CLEAR_ERRORS\n  };\n};\n\nconst receivePreferences = preferences => {\n  return {\n    type: RECEIVE_PREFERENCES,\n    preferences\n  };\n};\n\nexport const signup = user => dispatch => {\n  return SessionAPIUtil.signup(user).then(user => dispatch(receiveUserSignIn(user)), err => dispatch(receiveErrors(err.response.data)) // .catch(err => dispatch(receiveErrors(err.response.data)))\n  );\n}; //added by fei\n\nexport const login = user => dispatch => {\n  return SessionAPIUtil.login(user).then(res => {\n    //in axios, all of our json data is in data key of response\n    //response carries lot of information\n    const {\n      token\n    } = res.data; //localStorage allows us to save something on client side, so if user refreshes page, loads it in from localStor\n    // if close page, jwtToken still stores there\n\n    localStorage.setItem('jwtToken', token); //set header for future axios requests to pass along that json web token to backend to be authenticated\n\n    SessionAPIUtil.setAuthToken(token); //decoded contains all the data we get back from API\n    //res.data.token is the => is the json web token we are passing into jwt decode function\n\n    const decoded = jwt_decode(token);\n    dispatch(receiveCurrentUser(decoded));\n  }).catch(err => {\n    dispatch(receiveErrors(err.response.data));\n  });\n}; //added by fei\n// 1) remove jwtkey from localstorage 2) need to take jwt authHeader off of axios as a default\n// 3) get user out of redux store\n\nexport const logout = () => dispatch => {\n  localStorage.removeItem('jwtToken');\n  SessionAPIUtil.setAuthToken(false);\n  dispatch(logoutCurrentUser());\n};\nexport const updateUserPreferences = (id, preferences) => dispatch => {\n  debugger;\n  return SessionAPIUtil.updateUserPreferences(id, preferences).then(preferences => dispatch(receivePreferences(preferences)), err => dispatch(receiveErrors(err.response.data)));\n}; // miles_away: 100,\n//     hours_opened_left: 24,\n//         wifi: true,\n//             credit_card: false,\n//                 noise_level: false,\n//                     location_zip_code: 94111 }","map":{"version":3,"sources":["/mnt/c/Users/antr9/Desktop/studypal-master/frontend/src/actions/session_actions.js"],"names":["SessionAPIUtil","jwt_decode","RECEIVE_CURRENT_USER","LOGOUT_CURRENT_USER","RECEIVE_ERRORS","RECEIVE_USER_SIGN_IN","CLEAR_ERRORS","RECEIVE_PREFERENCES","receiveCurrentUser","currentUser","type","logoutCurrentUser","receiveErrors","errors","receiveUserSignIn","clearErrors","receivePreferences","preferences","signup","user","dispatch","then","err","response","data","login","res","token","localStorage","setItem","setAuthToken","decoded","catch","logout","removeItem","updateUserPreferences","id"],"mappings":"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","sourcesContent":["import * as SessionAPIUtil from \"../util/session_api_util\";\nimport jwt_decode from 'jwt-decode';\n// import SessionErrorsReducer from \"../reducers/session_errors_reducer\";\n\nexport const RECEIVE_CURRENT_USER = \"RECEIVE_CURRENT_USER\";\nexport const LOGOUT_CURRENT_USER = \"LOGOUT_CURRENT_USER\";\nexport const RECEIVE_ERRORS = \"RECEIVE_ERRORS\";\nexport const RECEIVE_USER_SIGN_IN = 'RECEIVE_USER_SIGN_IN';\nexport const CLEAR_ERRORS = 'CLEAR_ERRORS';\n\nexport const RECEIVE_PREFERENCES = \"RECEIVE_PREFERENCES\"\n\nconst receiveCurrentUser = (currentUser) => {\n    return({\n        type: RECEIVE_CURRENT_USER,\n        currentUser\n    });\n};\n\nconst logoutCurrentUser = () => ({\n    type: LOGOUT_CURRENT_USER\n});\n\nconst receiveErrors = errors => ({\n    type: RECEIVE_ERRORS,\n    errors\n});\n\n//added by Fei\nconst receiveUserSignIn = (currentUser) => {\n    return({\n    type: RECEIVE_USER_SIGN_IN,\n    currentUser\n});\n};\n\nexport const clearErrors = () => {\n    return({\n        type:CLEAR_ERRORS\n    })\n}\n\nconst receivePreferences = (preferences) => {\n    return ({\n    type: RECEIVE_PREFERENCES,\n    preferences})\n}\n\nexport const signup  = (user) => dispatch => {\n     \n    return(\n        SessionAPIUtil.signup(user)\n            .then((user) => dispatch(receiveUserSignIn(user)),\n            err => (dispatch(receiveErrors(err.response.data)))\n            // .catch(err => dispatch(receiveErrors(err.response.data)))\n        )\n    );\n};\n\n//added by fei\nexport const login = (user) => dispatch => {\n     \n    return SessionAPIUtil.login(user).then(res => {\n        //in axios, all of our json data is in data key of response\n        //response carries lot of information\n        const {token} = res.data;\n        //localStorage allows us to save something on client side, so if user refreshes page, loads it in from localStor\n        // if close page, jwtToken still stores there\n        localStorage.setItem('jwtToken', token);\n\n        //set header for future axios requests to pass along that json web token to backend to be authenticated\n        SessionAPIUtil.setAuthToken(token); \n        //decoded contains all the data we get back from API\n        //res.data.token is the => is the json web token we are passing into jwt decode function\n        const decoded = jwt_decode(token);\n         \n        dispatch(receiveCurrentUser(decoded));\n    })\n    .catch(err => {dispatch(receiveErrors(err.response.data));\n    });\n};\n\n//added by fei\n// 1) remove jwtkey from localstorage 2) need to take jwt authHeader off of axios as a default\n// 3) get user out of redux store\nexport const logout = () => dispatch => {\n     \n    localStorage.removeItem('jwtToken');\n    SessionAPIUtil.setAuthToken(false);\n    dispatch(logoutCurrentUser());\n};\n\nexport const updateUserPreferences = (id, preferences) => dispatch => {\n    debugger\n    return (\n        SessionAPIUtil.updateUserPreferences(id, preferences)\n            .then((preferences) => dispatch(receivePreferences(preferences)),\n                err => dispatch(receiveErrors(err.response.data))\n            ))\n}\n\n// miles_away: 100,\n//     hours_opened_left: 24,\n//         wifi: true,\n//             credit_card: false,\n//                 noise_level: false,\n//                     location_zip_code: 94111 }"]},"metadata":{},"sourceType":"module"}