{"ast":null,"code":"var _jsxFileName = \"/mnt/c/Users/antr9/Desktop/studypal-master/frontend/src/index.js\";\nimport { Stitch, AnonymousCredential } from \"mongodb-stitch-browser-sdk\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App'; // import * as serviceWorker from './serviceWorker';\n\nimport axios from 'axios';\nimport Root from \"./components/root\";\nimport configureStore from './store/store';\nimport './index.css';\nimport getYelpCafeById from './util/yelp_api';\nimport jwt_decode from 'jwt-decode';\nimport { setAuthToken } from './util/session_api_util';\nimport { logout } from './actions/session_actions';\nimport { getUser } from './util/user_api_util'; // import { updateUserPreferences } from './util/session_api_util'\n\nimport { updateUserPreferences, login } from './actions/session_actions';\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  // let store = configureStore({});\n  let store;\n  Stitch.initializeDefaultAppClient(\"studypal-vfqka\");\n\n  if (localStorage.jwtToken) {\n    setAuthToken(localStorage.jwtToken);\n    const decodedUser = jwt_decode(localStorage.jwtToken);\n    const preloadedState = {\n      session: {\n        isAuthenticated: true,\n        user: decodedUser\n      }\n    }; // const client = Stitch.defaultAppClient;\n\n    store = configureStore(preloadedState); //checking if jwt passed its configuration\n    //getting it in seconds\n\n    const currentTime = Date.now() / 1000; //if decoded expiration time is less than currentTime\n\n    if (decodedUser.exp < currentTime) {\n      //Logout the user and redirect to the login page\n      store.dispatch(logout());\n      window.location.href = 'login';\n    }\n\n    const client = Stitch.defaultAppClient;\n    client.auth.loginWithCredential(new AnonymousCredential()); // client.auth.loginWithCredential(new AnonymousCredential());\n  } else {\n    store = configureStore();\n  } // function initializeAndLogin() {\n  //   const client = Stitch.defaultAppClient;\n  //   client.auth.loginWithCredential(new AnonymousCredential())\n  // }\n  // window.onload = initializeAndLogin;\n\n\n  window.store = store;\n  window.getState = store.getState;\n  const root = document.getElementById(\"root\"); //  ;\n\n  ReactDOM.render(React.createElement(Root, {\n    store: store,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }), root);\n  window.axios = axios; // TESTING APIS\n\n  window.testId = \"WavvLdfdP6g8aZTtbBQHTw\";\n  window.getYelpCafeById = getYelpCafeById;\n  window.updateUserPreferences = updateUserPreferences;\n  window.getUser = getUser;\n  window.login = login;\n}); // If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n//don't need\n// serviceWorker.unregister();\n//set axios on the window\n// TESTING APIS","map":{"version":3,"sources":["/mnt/c/Users/antr9/Desktop/studypal-master/frontend/src/index.js"],"names":["Stitch","AnonymousCredential","React","ReactDOM","App","axios","Root","configureStore","getYelpCafeById","jwt_decode","setAuthToken","logout","getUser","updateUserPreferences","login","document","addEventListener","store","initializeDefaultAppClient","localStorage","jwtToken","decodedUser","preloadedState","session","isAuthenticated","user","currentTime","Date","now","exp","dispatch","window","location","href","client","defaultAppClient","auth","loginWithCredential","getState","root","getElementById","render","testId"],"mappings":";AAAA,SAASA,MAAT,EAAiBC,mBAAjB,QAA4C,4BAA5C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAO,aAAP;AACA,OAAOC,GAAP,MAAgB,OAAhB,C,CACA;;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,IAAP,MAAiB,mBAAjB;AACA,OAAOC,cAAP,MAA2B,eAA3B;AACA,OAAO,aAAP;AACA,OAAOC,eAAP,MAA4B,iBAA5B;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,SAAQC,YAAR,QAA2B,yBAA3B;AACA,SAAQC,MAAR,QAAqB,2BAArB;AAEA,SAASC,OAAT,QAAwB,sBAAxB,C,CACA;;AACA,SAASC,qBAAT,EAAgCC,KAAhC,QAA6C,2BAA7C;AAEAC,QAAQ,CAACC,gBAAT,CAA0B,kBAA1B,EAA8C,MAAM;AAChD;AACA,MAAIC,KAAJ;AACAjB,EAAAA,MAAM,CAACkB,0BAAP,CAAkC,gBAAlC;;AAEA,MAAGC,YAAY,CAACC,QAAhB,EAAyB;AACrBV,IAAAA,YAAY,CAACS,YAAY,CAACC,QAAd,CAAZ;AACA,UAAMC,WAAW,GAAGZ,UAAU,CAACU,YAAY,CAACC,QAAd,CAA9B;AACA,UAAME,cAAc,GAAG;AAACC,MAAAA,OAAO,EAAE;AAACC,QAAAA,eAAe,EAAE,IAAlB;AAAwBC,QAAAA,IAAI,EAAEJ;AAA9B;AAAV,KAAvB,CAHqB,CAKrB;;AAEAJ,IAAAA,KAAK,GAAGV,cAAc,CAACe,cAAD,CAAtB,CAPqB,CAQrB;AACA;;AACA,UAAMI,WAAW,GAAGC,IAAI,CAACC,GAAL,KAAW,IAA/B,CAVqB,CAWrB;;AACA,QAAGP,WAAW,CAACQ,GAAZ,GAAkBH,WAArB,EAAiC;AAC7B;AACAT,MAAAA,KAAK,CAACa,QAAN,CAAenB,MAAM,EAArB;AACAoB,MAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,OAAvB;AACH;;AACD,UAAMC,MAAM,GAAGlC,MAAM,CAACmC,gBAAtB;AACAD,IAAAA,MAAM,CAACE,IAAP,CAAYC,mBAAZ,CAAgC,IAAIpC,mBAAJ,EAAhC,EAlBqB,CAmBrB;AACH,GApBD,MAoBK;AACDgB,IAAAA,KAAK,GAAGV,cAAc,EAAtB;AACH,GA3B+C,CA6BhD;AACA;AACA;AACA;AAEA;;;AAEAwB,EAAAA,MAAM,CAACd,KAAP,GAAeA,KAAf;AACAc,EAAAA,MAAM,CAACO,QAAP,GAAkBrB,KAAK,CAACqB,QAAxB;AAEA,QAAMC,IAAI,GAAGxB,QAAQ,CAACyB,cAAT,CAAwB,MAAxB,CAAb,CAvCgD,CAyChD;;AACArC,EAAAA,QAAQ,CAACsC,MAAT,CAAgB,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAExB,KAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAhB,EAAuCsB,IAAvC;AAEAR,EAAAA,MAAM,CAAC1B,KAAP,GAAeA,KAAf,CA5CgD,CA8ChD;;AACA0B,EAAAA,MAAM,CAACW,MAAP,GAAgB,wBAAhB;AAEAX,EAAAA,MAAM,CAACvB,eAAP,GAAyBA,eAAzB;AAEAuB,EAAAA,MAAM,CAAClB,qBAAP,GAA+BA,qBAA/B;AACAkB,EAAAA,MAAM,CAACnB,OAAP,GAAiBA,OAAjB;AACAmB,EAAAA,MAAM,CAACjB,KAAP,GAAeA,KAAf;AACH,CAtDD,E,CA2DA;AACA;AACA;AAEA;AACA;AAEA;AAGA","sourcesContent":["import { Stitch, AnonymousCredential } from \"mongodb-stitch-browser-sdk\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n// import * as serviceWorker from './serviceWorker';\nimport axios from 'axios';\nimport Root from \"./components/root\";\nimport configureStore from './store/store';\nimport './index.css'\nimport getYelpCafeById from './util/yelp_api';\nimport jwt_decode from 'jwt-decode';\nimport {setAuthToken} from './util/session_api_util';\nimport {logout} from './actions/session_actions';\n\nimport { getUser } from './util/user_api_util'\n// import { updateUserPreferences } from './util/session_api_util'\nimport { updateUserPreferences, login } from './actions/session_actions'\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    // let store = configureStore({});\n    let store;\n    Stitch.initializeDefaultAppClient(\"studypal-vfqka\");\n\n    if(localStorage.jwtToken){\n        setAuthToken(localStorage.jwtToken);\n        const decodedUser = jwt_decode(localStorage.jwtToken);\n        const preloadedState = {session: {isAuthenticated: true, user: decodedUser}};\n        \n        // const client = Stitch.defaultAppClient;\n\n        store = configureStore(preloadedState);\n        //checking if jwt passed its configuration\n        //getting it in seconds\n        const currentTime = Date.now()/1000;\n        //if decoded expiration time is less than currentTime\n        if(decodedUser.exp < currentTime){\n            //Logout the user and redirect to the login page\n            store.dispatch(logout());\n            window.location.href = 'login';\n        }\n        const client = Stitch.defaultAppClient;\n        client.auth.loginWithCredential(new AnonymousCredential());\n        // client.auth.loginWithCredential(new AnonymousCredential());\n    }else{\n        store = configureStore();\n    }\n\n    // function initializeAndLogin() {\n    //   const client = Stitch.defaultAppClient;\n    //   client.auth.loginWithCredential(new AnonymousCredential())\n    // }\n\n    // window.onload = initializeAndLogin;\n\n    window.store = store\n    window.getState = store.getState\n\n    const root = document.getElementById(\"root\");\n\n    //  ;\n    ReactDOM.render(<Root store={store}/>, root);\n\n    window.axios = axios;\n\n    // TESTING APIS\n    window.testId = \"WavvLdfdP6g8aZTtbBQHTw\";\n  \n    window.getYelpCafeById = getYelpCafeById\n\n    window.updateUserPreferences = updateUserPreferences\n    window.getUser = getUser\n    window.login = login\n})\n\n\n\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n\n//don't need\n// serviceWorker.unregister();\n\n//set axios on the window\n\n\n// TESTING APIS\n"]},"metadata":{},"sourceType":"module"}